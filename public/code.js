"use strict";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function e(e,t,a,n){return new(a||(a=Promise))((function(i,s){function l(e){try{r(n.next(e))}catch(e){s(e)}}function o(e){try{r(n.throw(e))}catch(e){s(e)}}function r(e){var t;e.done?i(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(l,o)}r((n=n.apply(e,t||[])).next())}))}let t=210,a=figma.currentPage;function n(){let e=a.selection,t=[];return e&&e.forEach(e=>{"FRAME"===e.type&&t.push(e)}),t}function i(e){let t=e.id,n=a.findOne(e=>"GROUP"===e.type&&"status_annotations"===e.name);e.setSharedPluginData("statusannotations","status",""),n&&n.children.forEach(e=>{let a=e.getPluginData("frameId");t===a&&e.remove()})}function s(){let e=a.findOne(e=>"GROUP"===e.type&&"status_annotations"===e.name);e&&e.children.forEach(e=>{let t=e.getPluginData("frameId"),a=figma.getNodeById(t);if(a){let t=a.y-e.height-8,n=a.x+a.width-e.width;e.x=n,e.y=t}else e.remove()})}function l(e){let t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16)/255,g:parseInt(t[2],16)/255,b:parseInt(t[3],16)/255}:null}s(),"refresh"===figma.command?(s(),figma.closePlugin()):figma.showUI(__html__,{width:172,height:t}),figma.ui.onmessage=o=>{switch(o.type){case"height":t=o.height,figma.ui.resize(172,t);break;case"addStatus":!function(t){e(this,void 0,void 0,(function*(){let e=n();if(0!==e.length){let n=0,s=figma.createFrame();s.counterAxisSizingMode="AUTO",s.layoutMode="HORIZONTAL",s.itemSpacing=4,s.horizontalPadding=6,s.verticalPadding=4,s.name="annotation",s.topLeftRadius=3,s.topRightRadius=3,s.strokes=[{type:"SOLID",visible:!0,opacity:1,blendMode:"NORMAL",color:l("#DBDBDB")}],s.strokeWeight=1;let o=figma.createText();o.name=t.title;let r={family:"Inter",style:"Regular"};yield figma.loadFontAsync(r),o.fontName=r,o.fontSize=12,o.lineHeight={value:16,unit:"PIXELS"},o.characters=t.title;let c=figma.createNodeFromSvg(t.icon);c.name="icon-"+t.slug,c.layoutAlign="CENTER",s.insertChild(0,o),s.insertChild(1,c);let f=[];f.push(s);let u=figma.group(f,a);u.name=t.title;let h=l(t.color);h=Object.assign({a:1},h),u.effects=[{blendMode:"NORMAL",color:h,offset:{x:0,y:-2},radius:0,type:"INNER_SHADOW",visible:!0}],e.forEach(e=>{let s;i(e),s=0===n?u:u.clone();let l=e.id,o=e.y-s.height-8,r=e.x+e.width-s.width;s.x=r,s.y=o,s.setPluginData("frameId",l);let c=a.findOne(e=>"GROUP"===e.type&&"status_annotations"===e.name);if(c)c.appendChild(s);else{let e=[];e.push(s);let t=figma.group(e,a);t.name="status_annotations",t.locked=!0,t.expanded=!1}e.setRelaunchData({status:t.title}),e.setSharedPluginData("statusannotations","status",t.title),a.setRelaunchData({refresh:""}),n++})}else figma.notify("Please select a frame")}))}(o.status);break;case"clear":!function(){let e=n();e?e.forEach(e=>{i(e),e.setRelaunchData({})}):figma.notify("Please select a frame with a status.")}();break;case"clearAll":!function(){let e=a.findOne(e=>"GROUP"===e.type&&"status_annotations"===e.name);e&&e.remove();a.findAll(e=>"FRAME"===e.type).forEach(e=>{e.setRelaunchData({})}),a.setRelaunchData({})}();break;case"refresh":s()}};
